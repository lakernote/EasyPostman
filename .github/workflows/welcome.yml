name: Welcome New Contributors

on:
  issues:
    types: [opened]
  pull_request_target:
    types: [opened]

jobs:
  welcome:
    runs-on: ubuntu-latest
    permissions:
      issues: write
      pull-requests: write

    steps:
      - name: Welcome new contributor
        uses: actions/github-script@v7
        with:
          script: |
            const isIssue = context.payload.issue !== undefined;
            
            if (isIssue) {
              // Check if this is the user's first issue
              const issues = await github.rest.issues.listForRepo({
                owner: context.repo.owner,
                repo: context.repo.repo,
                creator: context.payload.sender.login,
                state: 'all'
              });
              
              const isFirstIssue = issues.data.length === 1;
              
              if (isFirstIssue) {
                const issueComment = `ğŸ‘‹ ä½ å¥½ @${context.payload.sender.login}ï¼æ„Ÿè°¢ä½ æäº¤ç¬¬ä¸€ä¸ª Issueï¼
                
              Hi @${context.payload.sender.login}! Thank you for submitting your first issue!
              
              æˆ‘ä»¬ä¼šå°½å¿«æŸ¥çœ‹å¹¶å›å¤ä½ ã€‚åœ¨ç­‰å¾…çš„è¿‡ç¨‹ä¸­ï¼Œä½ å¯ä»¥ï¼š
              We'll review and respond as soon as possible. While waiting, you can:
              
              - ğŸ“– æŸ¥çœ‹ [æ–‡æ¡£](https://github.com/lakernote/easy-postman#readme) | Check the [documentation](https://github.com/lakernote/easy-postman#readme)
              - ğŸ’¬ åŠ å…¥ [è®¨è®ºåŒº](https://github.com/lakernote/easy-postman/discussions) | Join the [Discussions](https://github.com/lakernote/easy-postman/discussions)
              - â­ ç»™é¡¹ç›®ç‚¹ä¸ª Starï¼| Give the project a Star!
              
              å¦‚æœä½ æ„¿æ„å¸®åŠ©è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ¬¢è¿æäº¤ PRï¼
              If you'd like to help fix this issue, PRs are welcome!
              `;
                
                await github.rest.issues.createComment({
                  owner: context.repo.owner,
                  repo: context.repo.repo,
                  issue_number: context.payload.issue.number,
                  body: issueComment
                });
              }
            } else {
              // Check if this is the user's first PR
              const pulls = await github.rest.pulls.list({
                owner: context.repo.owner,
                repo: context.repo.repo,
                state: 'all',
                creator: context.payload.sender.login
              });
              
              const isFirstPR = pulls.data.length === 1;
              
              if (isFirstPR) {
                const prComment = `ğŸ‰ æ„Ÿè°¢ä½ çš„ç¬¬ä¸€ä¸ª Pull Request @${context.payload.sender.login}ï¼
                
              ğŸ‰ Thank you for your first Pull Request @${context.payload.sender.login}!
              
              æˆ‘ä»¬çš„ç»´æŠ¤è€…ä¼šå°½å¿«å®¡æŸ¥ä½ çš„ä»£ç ã€‚åœ¨ç­‰å¾…çš„è¿‡ç¨‹ä¸­ï¼Œè¯·ç¡®ä¿ï¼š
              Our maintainers will review your code soon. While waiting, please ensure:
              
              - âœ… ä»£ç å¯ä»¥æˆåŠŸç¼–è¯‘ | Code compiles successfully
              - âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡ | All tests pass
              - âœ… éµå¾ª [è´¡çŒ®æŒ‡å—](https://github.com/lakernote/easy-postman/blob/main/.github/CONTRIBUTING.md) | Follow the [Contributing Guide](https://github.com/lakernote/easy-postman/blob/main/.github/CONTRIBUTING.md)
              - âœ… PR æè¿°æ¸…æ™°å®Œæ•´ | PR description is clear and complete
              
              å†æ¬¡æ„Ÿè°¢ä½ çš„è´¡çŒ®ï¼ğŸ™
              Thank you again for your contribution! ğŸ™
              `;
                
                await github.rest.issues.createComment({
                  owner: context.repo.owner,
                  repo: context.repo.repo,
                  issue_number: context.payload.pull_request.number,
                  body: prComment
                });
              }
            }

